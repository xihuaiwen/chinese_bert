{
    "task": "pretraining",
    "attention_probs_dropout_prob": 0,
    "hidden_act": "gelu",
    "hidden_dropout_prob": 0.1,
    "hidden_size": 1024,
    "initializer_range": 0.02,
    "max_position_embeddings": 512,
    "num_attention_heads": 16,
    "num_hidden_layers": 24,
    "use_attention_projection_bias": false,
    "use_cls_layer": false,
    "use_qkv_bias": false,
    
    "pipeline_stages": [
        ["emb", "pos","hid","hid","hid"],
        ["hid","hid","hid","hid","hid","hid","hid"],
        ["hid","hid","hid","hid","hid","hid","hid"],
        ["hid","hid","hid","hid","hid","hid","hid"],
        ["mlm","nsp"]],
    "device_mapping":[0,1,2,3,0],
    "type_vocab_size": 2,
    "vocab_size": 30528,
    "seq_length": 128,
    "batch_size": 2,
    "batches_per_step": 1,
    "num_train_steps": 7264,
    "epsilon": 0.0001,
    "max_predictions_per_seq": 20,
    "lr_schedule": "custom",
    "lr_schedule_by_step": {
      "0": 1.0e-7,
      "16": 4.797832818915696e-5,
      "32": 9.595665637831393e-5,
      "48": 0.0001439349845674709,
      "64": 0.00019191331275662785,
      "80": 0.00023989164094578478,
      "96": 0.0002878699691349418,
      "112": 0.0003358482973240987,
      "128": 0.0003838266255132557,
      "144": 0.00043180495370241266,
      "160": 0.00047978328189156956,
      "176": 0.0005277616100807266,
      "192": 0.0005757399382698836,
      "208": 0.0006237182664590405,
      "224": 0.0006716965946481974,
      "240": 0.0007196749228373544,
      "256": 0.0007676532510265114,
      "272": 0.0008156315792156684,
      "288": 0.0008636099074048253,
      "304": 0.0009115882355939822,
      "320": 0.0009595665637831391,
      "336": 0.0010075448919722961,
      "352": 0.0010555232201614531,
      "368": 0.0011035015483506101,
      "384": 0.0011514798765397672,
      "400": 0.0011994582047289242,
      "416": 0.001247436532918081,
      "432": 0.001295414861107238,
      "448": 0.0013433931892963948,
      "464": 0.0013913715174855518,
      "480": 0.0014393498456747088,
      "496": 0.0014873281738638658,
      "512": 0.0015353065020530228,
      "528": 0.0015832848302421796,
      "544": 0.0016312631584313368,
      "560": 0.0016792414866204936,
      "576": 0.0017272198148096506,
      "592": 0.0017751981429988076,
      "608": 0.0018231764711879644,
      "624": 0.0018711547993771214,
      "640": 0.0019191331275662782,
      "656": 0.0019671114557554357,
      "672": 0.0020150897839445923,
      "688": 0.0020630681121337493,
      "704": 0.0021110464403229063,
      "720": 0.0021590247685120633,
      "736": 0.0022070030967012203,
      "752": 0.002254981424890377,
      "768": 0.0023029597530795343,
      "784": 0.002350938081268691,
      "800": 0.0023989164094578483,
      "816": 0.002446894737647005,
      "832": 0.002494873065836162,
      "848": 0.002542851394025319,
      "864": 0.002590829722214476,
      "880": 0.002638808050403633,
      "896": 0.0026867863785927895,
      "912": 0.002734764706781947,
      "928": 0.0027827430349711036,
      "944": 0.0028307213631602606,
      "960": 0.0028786996913494176,
      "976": 0.0029266780195385746,
      "992": 0.0029746563477277316,
      "1008": 0.0030226346759168886,
      "1024": 0.0030706130041060456,
      "1040": 0.0031185913322952026,
      "1056": 0.003166569660484359,
      "1072": 0.003214547988673516,
      "1088": 0.0032625263168626737,
      "1104": 0.0033105046450518302,
      "1120": 0.0033584829732409872,
      "1136": 0.003406461301430144,
      "1152": 0.0034544396296193013,
      "1168": 0.0035024179578084583,
      "1184": 0.0035503962859976153,
      "1200": 0.003598374614186772,
      "1216": 0.003646352942375929,
      "1232": 0.0036943312705650863,
      "1248": 0.003742309598754243,
      "1264": 0.0037902879269434,
      "1280": 0.0038382662551325565,
      "1296": 0.0038862445833217135,
      "1312": 0.003934222911510871,
      "1328": 0.0039822012397000275,
      "1344": 0.0040301795678891845,
      "1360": 0.0040781578960783415,
      "1376": 0.0041261362242674985,
      "1392": 0.0041741145524566555,
      "1408": 0.0042220928806458126,
      "1424": 0.0042700712088349696,
      "1440": 0.004318049537024127,
      "1456": 0.004366027865213284,
      "1472": 0.004414006193402441,
      "1488": 0.004461984521591598,
      "1504": 0.004509962849780754,
      "1520": 0.004557941177969912,
      "1536": 0.004605919506159069,
      "1552": 0.004653897834348226,
      "1568": 0.004701876162537382,
      "1584": 0.004749854490726539,
      "1600": 0.004797832818915697,
      "1616": 0.004845811147104853,
      "1632": 0.00489378947529401,
      "1648": 0.004941767803483167,
      "1664": 0.004989746131672324,
      "1680": 0.005037724459861481,
      "1696": 0.005085702788050638,
      "1712": 0.005133681116239795,
      "1728": 0.005181659444428952,
      "1744": 0.005229637772618109,
      "1760": 0.005277616100807266,
      "1776": 0.005325594428996423,
      "1792": 0.005373572757185579,
      "1808": 0.005421551085374736,
      "1824": 0.005469529413563894,
      "1840": 0.005517507741753051,
      "1856": 0.005565486069942207,
      "1872": 0.005613464398131364,
      "1888": 0.005661442726320521,
      "1904": 0.005709421054509678,
      "1920": 0.005757399382698835,
      "1936": 0.005805377710887992,
      "1952": 0.005853356039077149,
      "1968": 0.005901334367266306,
      "1984": 0.005949312695455463,
      "2000": 0.00599729102364462,
      "2016": 0.0059820174979372046,
      "2032": 0.005962958899775717,
      "2048": 0.005943900301614227,
      "2064": 0.005924841703452739,
      "2080": 0.005905783105291251,
      "2096": 0.005886724507129762,
      "2112": 0.005867665908968274,
      "2128": 0.005848607310806784,
      "2144": 0.0058295487126452964,
      "2160": 0.0058104901144838085,
      "2176": 0.00579143151632232,
      "2192": 0.005772372918160832,
      "2208": 0.005753314319999342,
      "2224": 0.005734255721837854,
      "2240": 0.005715197123676365,
      "2256": 0.005696138525514877,
      "2272": 0.005677079927353388,
      "2288": 0.0056580213291918995,
      "2304": 0.0056389627310304115,
      "2320": 0.005619904132868923,
      "2336": 0.005600845534707434,
      "2352": 0.005581786936545946,
      "2368": 0.005562728338384457,
      "2384": 0.005543669740222969,
      "2400": 0.00552461114206148,
      "2416": 0.005505552543899991,
      "2432": 0.005486493945738503,
      "2448": 0.005467435347577015,
      "2464": 0.005448376749415527,
      "2480": 0.005429318151254038,
      "2496": 0.005410259553092549,
      "2512": 0.005391200954931061,
      "2528": 0.005372142356769572,
      "2544": 0.005353083758608084,
      "2560": 0.005334025160446595,
      "2576": 0.0053149665622851065,
      "2592": 0.0052959079641236185,
      "2608": 0.00527684936596213,
      "2624": 0.005257790767800642,
      "2640": 0.005238732169639153,
      "2656": 0.005219673571477664,
      "2672": 0.005200614973316176,
      "2688": 0.005181556375154687,
      "2704": 0.005162497776993198,
      "2720": 0.00514343917883171,
      "2736": 0.0051243805806702215,
      "2752": 0.0051053219825087336,
      "2768": 0.005086263384347245,
      "2784": 0.005067204786185756,
      "2800": 0.005048146188024268,
      "2816": 0.005029087589862779,
      "2832": 0.005010028991701291,
      "2848": 0.004990970393539802,
      "2864": 0.004971911795378313,
      "2880": 0.0049528531972168255,
      "2896": 0.004933794599055337,
      "2912": 0.004914736000893849,
      "2928": 0.00489567740273236,
      "2944": 0.004876618804570871,
      "2960": 0.004857560206409383,
      "2976": 0.004838501608247894,
      "2992": 0.004819443010086405,
      "3008": 0.004800384411924917,
      "3024": 0.0047813258137634285,
      "3040": 0.0047622672156019405,
      "3056": 0.004743208617440452,
      "3072": 0.004724150019278963,
      "3088": 0.004705091421117475,
      "3104": 0.004686032822955986,
      "3120": 0.004666974224794498,
      "3136": 0.004647915626633009,
      "3152": 0.00462885702847152,
      "3168": 0.004609798430310032,
      "3184": 0.004590739832148544,
      "3200": 0.004571681233987056,
      "3216": 0.004552622635825567,
      "3232": 0.004533564037664078,
      "3248": 0.004514505439502589,
      "3264": 0.004495446841341101,
      "3280": 0.004476388243179612,
      "3296": 0.004457329645018124,
      "3312": 0.0044382710468566355,
      "3328": 0.004419212448695147,
      "3344": 0.004400153850533659,
      "3360": 0.00438109525237217,
      "3376": 0.004362036654210682,
      "3392": 0.004342978056049193,
      "3408": 0.004323919457887704,
      "3424": 0.004304860859726216,
      "3440": 0.004285802261564727,
      "3456": 0.004266743663403239,
      "3472": 0.0042476850652417505,
      "3488": 0.004228626467080262,
      "3504": 0.004209567868918774,
      "3520": 0.004190509270757285,
      "3536": 0.004171450672595796,
      "3552": 0.004152392074434308,
      "3568": 0.004133333476272819,
      "3584": 0.004114274878111331,
      "3600": 0.0040952162799498424,
      "3616": 0.004076157681788354,
      "3632": 0.004057099083626866,
      "3648": 0.004038040485465377,
      "3664": 0.004018981887303889,
      "3680": 0.0039999232891424,
      "3696": 0.003980864690980911,
      "3712": 0.003961806092819423,
      "3728": 0.003942747494657934,
      "3744": 0.003923688896496446,
      "3760": 0.0039046302983349575,
      "3776": 0.003885571700173469,
      "3792": 0.0038665131020119807,
      "3808": 0.0038474545038504914,
      "3824": 0.003828395905689004,
      "3840": 0.003809337307527515,
      "3856": 0.0037902787093660266,
      "3872": 0.0037712201112045382,
      "3888": 0.003752161513043049,
      "3904": 0.0037331029148815606,
      "3920": 0.003714044316720072,
      "3936": 0.0036949857185585833,
      "3952": 0.0036759271203970958,
      "3968": 0.0036568685222356065,
      "3984": 0.003637809924074118,
      "4000": 0.0036187513259126297,
      "4016": 0.003599692727751141,
      "4032": 0.0035806341295896533,
      "4048": 0.003561575531428164,
      "4064": 0.0035425169332666765,
      "4080": 0.0035234583351051872,
      "4096": 0.0035043997369436993,
      "4112": 0.003485341138782211,
      "4128": 0.0034662825406207216,
      "4144": 0.003447223942459234,
      "4160": 0.0034281653442977448,
      "4176": 0.003409106746136257,
      "4192": 0.0033900481479747684,
      "4208": 0.003370989549813279,
      "4224": 0.0033519309516517907,
      "4240": 0.0033328723534903023,
      "4256": 0.0033138137553288143,
      "4272": 0.003294755157167326,
      "4288": 0.0032756965590058367,
      "4304": 0.0032566379608443483,
      "4320": 0.00323757936268286,
      "4336": 0.003218520764521371,
      "4352": 0.0031994621663598835,
      "4368": 0.003180403568198394,
      "4384": 0.003161344970036906,
      "4400": 0.0031422863718754174,
      "4416": 0.0031232277737139286,
      "4432": 0.003104169175552441,
      "4448": 0.0030851105773909517,
      "4464": 0.0030660519792294633,
      "4480": 0.003046993381067975,
      "4496": 0.003027934782906486,
      "4512": 0.0030088761847449986,
      "4528": 0.0029898175865835093,
      "4544": 0.002970758988422021,
      "4560": 0.0029517003902605325,
      "4576": 0.0029326417920990436,
      "4592": 0.0029135831939375552,
      "4608": 0.002894524595776067,
      "4624": 0.0028754659976145784,
      "4640": 0.00285640739945309,
      "4656": 0.002837348801291601,
      "4672": 0.0028182902031301128,
      "4688": 0.0027992316049686244,
      "4704": 0.002780173006807136,
      "4720": 0.002761114408645647,
      "4736": 0.0027420558104841587,
      "4752": 0.0027229972123226703,
      "4768": 0.002703938614161182,
      "4784": 0.0026848800159996935,
      "4800": 0.0026658214178382047,
      "4816": 0.0026467628196767162,
      "4832": 0.002627704221515228,
      "4848": 0.0026086456233537394,
      "4864": 0.002589587025192251,
      "4880": 0.002570528427030762,
      "4896": 0.002551469828869274,
      "4912": 0.0025324112307077854,
      "4928": 0.002513352632546297,
      "4944": 0.002494294034384808,
      "4960": 0.0024752354362233197,
      "4976": 0.0024561768380618313,
      "4992": 0.002437118239900343,
      "5008": 0.0024180596417388545,
      "5024": 0.0023990010435773657,
      "5040": 0.0023799424454158773,
      "5056": 0.002360883847254389,
      "5072": 0.0023418252490929005,
      "5088": 0.002322766650931411,
      "5104": 0.002303708052769923,
      "5120": 0.002284649454608435,
      "5136": 0.0022655908564469464,
      "5152": 0.002246532258285458,
      "5168": 0.0022274736601239687,
      "5184": 0.0022084150619624808,
      "5200": 0.0021893564638009923,
      "5216": 0.002170297865639504,
      "5232": 0.0021512392674780147,
      "5248": 0.0021321806693165263,
      "5264": 0.0021131220711550383,
      "5280": 0.00209406347299355,
      "5296": 0.0020750048748320615,
      "5312": 0.002055946276670572,
      "5328": 0.002036887678509084,
      "5344": 0.0020178290803475954,
      "5360": 0.0019987704821861074,
      "5376": 0.001979711884024619,
      "5392": 0.0019606532858631297,
      "5408": 0.0019415946877016416,
      "5424": 0.0019225360895401531,
      "5440": 0.0019034774913786647,
      "5456": 0.0018844188932171757,
      "5472": 0.0018653602950556873,
      "5488": 0.001846301696894199,
      "5504": 0.0018272430987327107,
      "5520": 0.0018081845005712223,
      "5536": 0.0017891259024097332,
      "5552": 0.0017700673042482448,
      "5568": 0.0017510087060867566,
      "5584": 0.0017319501079252682,
      "5600": 0.0017128915097637792,
      "5616": 0.0016938329116022908,
      "5632": 0.0016747743134408024,
      "5648": 0.0016557157152793142,
      "5664": 0.0016366571171178258,
      "5680": 0.0016175985189563367,
      "5696": 0.0015985399207948483,
      "5712": 0.00157948132263336,
      "5728": 0.0015604227244718717,
      "5744": 0.0015413641263103833,
      "5760": 0.0015223055281488942,
      "5776": 0.0015032469299874058,
      "5792": 0.0014841883318259174,
      "5808": 0.0014651297336644292,
      "5824": 0.0014460711355029402,
      "5840": 0.0014270125373414518,
      "5856": 0.0014079539391799634,
      "5872": 0.001388895341018475,
      "5888": 0.0013698367428569866,
      "5904": 0.0013507781446954977,
      "5920": 0.0013317195465340093,
      "5936": 0.001312660948372521,
      "5952": 0.0012936023502110325,
      "5968": 0.0012745437520495435,
      "5984": 0.0012554851538880553,
      "6000": 0.0012364265557265669,
      "6016": 0.0012173679575650785,
      "6032": 0.00119830935940359,
      "6048": 0.001179250761242101,
      "6064": 0.0011601921630806128,
      "6080": 0.0011411335649191244,
      "6096": 0.001122074966757636,
      "6112": 0.001103016368596147,
      "6128": 0.0010839577704346585,
      "6144": 0.0010648991722731701,
      "6160": 0.001045840574111682,
      "6176": 0.0010267819759501935,
      "6192": 0.0010077233777887045,
      "6208": 0.000988664779627216,
      "6224": 0.0009696061814657278,
      "6240": 0.0009505475833042394,
      "6256": 0.0009314889851427511,
      "6272": 0.000912430386981262,
      "6288": 0.0008933717888197736,
      "6304": 0.0008743131906582853,
      "6320": 0.0008552545924967969,
      "6336": 0.0008361959943353079,
      "6352": 0.0008171373961738196,
      "6368": 0.0007980787980123312,
      "6384": 0.0007790201998508429,
      "6400": 0.0007599616016893545,
      "6416": 0.0007409030035278654,
      "6432": 0.0007218444053663771,
      "6448": 0.0007027858072048887,
      "6464": 0.0006837272090434004,
      "6480": 0.0006646686108819113,
      "6496": 0.0006456100127204229,
      "6512": 0.0006265514145589346,
      "6528": 0.0006074928163974462,
      "6544": 0.0005884342182359579,
      "6560": 0.0005693756200744689,
      "6576": 0.0005503170219129805,
      "6592": 0.0005312584237514922,
      "6608": 0.0005121998255900038,
      "6624": 0.0004931412274285154,
      "6640": 0.00047408262926702636,
      "6656": 0.000455024031105538,
      "6672": 0.00043596543294404966,
      "6688": 0.0004169068347825613,
      "6704": 0.00039784823662107225,
      "6720": 0.0003787896384595839,
      "6736": 0.00035973104029809555,
      "6752": 0.0003406724421366072,
      "6768": 0.00032161384397511885,
      "6784": 0.0003025552458136298,
      "6800": 0.00028349664765214144,
      "6816": 0.0002644380494906531,
      "6832": 0.00024537945132916474,
      "6848": 0.0002263208531676757,
      "6864": 0.00020726225500618733,
      "6880": 0.00018820365684469898,
      "6896": 0.00016914505868321063,
      "6912": 0.00015008646052172225,
      "6928": 0.00013102786236023322,
      "6944": 0.00011196926419874487,
      "6960": 9.29106660372565e-5,
      "6976": 7.385206787576815e-5,
      "6992": 5.479346971427979e-5,
      "7008": 3.573487155279076e-5
    },
    "loss_scaling": 128,
    "optimiser": "lamb",
    "pipeline_depth": 8190,
    "parallell_io_threads": 16,
    "pipeline_schedule": "Grouped",
    "replicas": 1,
    "precision": "16",
    "seed": 1234,
    "no_outlining": true,
    "stochastic_rounding": true,
    "xla_recompute": true,
    "fp_exceptions": false,
    "matmul_serialize_factor": 6,
    "steps_per_tensorboard": 12800,
    "steps_per_ckpts": 100,
    "steps_per_logs": 1,
    "duplicate_factor":5,

    "available_memory_proportion": 0.11,
    "half_partial": "half",
    "reduction_type": "mean",

    "init_checkpoint":"",
    "restore_dir": "",
    "save_path": "/localdata/liguoying/ckpts/test-large/phase1",
    "train_file": "/localdata/tianzhiwei/wikicorpus_en/training/*.tfrecord"
  }