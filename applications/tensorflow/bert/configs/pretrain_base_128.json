{
  "task": "pretraining",
  "attention_probs_dropout_prob": 0.0,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "max_position_embeddings": 512,
  "vocab_size": 30400,
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "type_vocab_size": 2,
  "seq_length": 128,
  "max_predictions_per_seq": 20,
  "use_attention_projection_bias": false,
  "use_cls_layer": false,
  "use_qkv_bias": false,

  "pipeline_stages": [
    ["emb"],
    ["emb"],
    ["pos"],
    ["hid","hid"],
    ["hid","hid"],
    ["hid","hid"],
    ["hid","hid"],
    ["hid","hid"],
    ["hid","hid"],
    ["mlm"],
    ["mlm"],
    ["nsp"]],
  "device_mapping":[0,1,0,2,3,4,5,6,7,0,1,1],
  "batch_size": 1,
  "batches_per_step": 128,
  "num_train_steps": 768000,
  "base_learning_rate": 0.0001,
  "lr_schedule": "custom",
  "lr_schedule_by_step": {
    "0": 0.0001,
    "65535": 9.5e-05,
    "131072": 9.025e-05,
    "196608": 8.573749999999999e-05,
    "262144": 8.1450625e-05,
    "327680": 7.737809374999998e-05,
    "393216": 7.350918906249998e-05,
    "458752": 6.983372960937497e-05,
    "524288": 6.634204312890623e-05,
    "589824": 6.30249409724609e-05,
    "655360": 5.987369392383787e-05,
    "720896": 5.688000922764597e-05,
    "786432": 5.403600876626367e-05,
    "851968": 5.1334208327950485e-05,
    "917504": 4.876749791155295e-05,
    "983040": 4.6329123015975305e-05,
    "1048576": 4.4012666865176535e-05,
    "1114112": 4.181203352191771e-05,
    "1179648": 3.972143184582182e-05
  },
  "loss_scaling": 20.0,
  "optimizer": "momentum",
  "momentum": 0.98,
  "pipeline_depth":120,
  "pipeline_schedule": "Grouped",
  "replicas": 2,
  "half_partial":"float",
  
  "precision": "16",
  "seed": 1234,
  "steps_per_tensorboard": 12800,
  "steps_per_logs": 128,
  "steps_per_ckpts": 5000,
  "warmup_steps": 10000,
  "available_memory_proportion":0.11,
  "variable_offloading": false,
  "parallell_io_threads": 16,
  "matmul_serialize_factor":4,
  "duplicate_factor":5,
  "no_outlining": true,
  "stochastic_rounding": true,
  "xla_recompute": true,
  "fp_exceptions": false,

  "init_checkpoint":"",
  "restore_dir": "",
  "variable_filter":"",
  "save_path": "/localdata/liguoying/ckpts/base/phase1",
  "train_file":"/localdata/liguoying/datasets/bert/original/seqlen128_msk20_dup5/*"
}
